#!/usr/bin/env ruby
# frozen_string_literal: true

require 'optparse'
require_relative '../lib/keep_up'

options = {
  local: false,
  test_command: 'bundle exec rake',
  skip: []
}

opt_parser = OptionParser.new do |parser|
  parser.on('--[no-]local') { |local| options[:local] = local }
  parser.on('--test-command=COMMAND') { |command| options[:test_command] = command }
  parser.on('--skip=SKIPPED_GEM') { |gemname| options[:skip] << gemname }
end

opt_parser.parse!

begin
  KeepUp::Application.new(options).run
rescue KeepUp::BailOut => e
  warn e.message
  exit 1
end
