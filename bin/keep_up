#!/usr/bin/env ruby

require 'optparse'
require_relative '../lib/keep_up'

options = {
  local: false,
  test_command: 'bundle exec rake',
  skip: []
}
OptionParser.new do |parser|
  parser.on('--[no-]local') do |local|
    options[:local] = local
  end

  parser.on('--test-command=COMMAND') do |command|
    options[:test_command] = command
  end

  parser.on('--skip=SKIPPED_GEM') do |gemname|
    options[:skip] << gemname
  end
end.parse!

begin
  KeepUp::Application.new(options).run
rescue KeepUp::BailOut => e
  puts "Failure: #{e.message}"
end
